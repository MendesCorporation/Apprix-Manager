import{_ as ue,q as E,j as h,g as p,i as R,c as T,o as _,n as D,k as x,Z as K,F as ie,f as se,a5 as ee,a4 as Gt,ao as he,a6 as ht,a0 as Ne,d as me,l as oe,ap as Xt,aq as Zt,ar as Qt,b as ae,a3 as en,a8 as tn,as as ft,r as te,at as nn,s as mt,e as fe,au as le,w as ne,W as st,m as vt,av as on,V as ln,aw as sn,v as an,Y as gt,p as A,ax as rn,an as cn,ay as at}from"./main-NMbsWZXH.js";const un='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up"><path d="m18 15-6-6-6 6"/></svg>',dn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>',rt='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18M6 6l12 12"/></svg>',hn={props:{content:{type:Object,required:!0}},emits:["remove-multiselect-value"],setup(e,{emit:t}){const{getIcon:i}=wwLib.useIcons(),n=E("_wwSelect:registerTriggerLocalContext"),o=E("_wwSelect:localContext"),a=h(()=>e.content.selectType==="single"),s=h(()=>wwLib.wwLang.getText(e.content.placeholder)),l=h(()=>{var I,B,V,L,$;return($=(L=(V=(B=(I=o.value)==null?void 0:I.data)==null?void 0:B.select)==null?void 0:V.active)==null?void 0:L.details)==null?void 0:$.label}),r=h(()=>{var I,B,V,L,$,y,M,C,F,W;return!!(($=(L=(V=(B=(I=o.value)==null?void 0:I.data)==null?void 0:B.select)==null?void 0:V.active)==null?void 0:L.details)!=null&&$.label)||((W=(F=(C=(M=(y=o.value)==null?void 0:y.data)==null?void 0:M.select)==null?void 0:C.active)==null?void 0:F.details)==null?void 0:W.length)>0}),c=h(()=>{var I,B,V,L;return(L=(V=(B=(I=o.value)==null?void 0:I.data)==null?void 0:B.select)==null?void 0:V.utils)==null?void 0:L.isOpen}),u=p({placeholder:s});n({data:u,methods:{},markdown:"### Select Trigger local informations\n\n- `placeholder`: The placeholder text for the select trigger."});const k=h(()=>{const I=e.content.triggerBorder?{"border-top":e.content.triggerBorderTop,"border-right":e.content.triggerBorderRight,"border-bottom":e.content.triggerBorderBottom,"border-left":e.content.triggerBorderLeft}:{border:e.content.triggerBorderAll};return{padding:e.content.triggerPadding,margin:e.content.triggerMargin,"background-color":e.content.triggerBgColor,width:"100%",height:e.content.triggerHeight,"border-radius":e.content.triggerBorderRadius,"box-shadow":e.content.triggerShadows,cursor:"pointer",display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between",...I}}),P=h(()=>({width:e.content.triggerIconSize,color:e.content.triggerIconColor,display:"flex","align-items":"center","justify-content":"center","pointer-events":"none"})),Y=h(()=>({"font-size":e.content.selectedFontSize,"font-family":e.content.selectedFontFamily,color:e.content.selectedFontColor,"font-weight":e.content.selectedFontWeight,"text-align":e.content.selectedTextAlign,width:"100%"})),S=h(()=>({"font-size":e.content.placeholderFontSize,"font-family":e.content.placeholderFontFamily,color:e.content.placeholderFontColor,"font-weight":e.content.placeholderFontWeight,"text-align":e.content.placeholderTextAlign,width:"100%"})),O=h(()=>{const I=e.content.chipBorder?{"border-top":e.content.chipBorderTop,"border-right":e.content.chipBorderRight,"border-bottom":e.content.chipBorderBottom,"border-left":e.content.chipBorderLeft}:{border:e.content.chipBorderAll};return{"font-size":e.content.chipFontSize,"font-family":e.content.chipFontFamily,color:e.content.chipFontColor,"font-weight":e.content.chipFontWeight,padding:e.content.chipPadding,"background-color":e.content.chipBgColor,"border-radius":e.content.chipBorderRadius,...I}}),m=p(null),f=p(null);R([c,()=>e.content.triggerIconOpen,()=>e.content.triggerIconClose],async()=>{const I=c.value?"triggerIconClose":"triggerIconOpen",B=c.value?un:dn;e.content[I]?m.value=await i(e.content[I])||B:m.value=B},{immediate:!0}),R(()=>e.content.chipIconUnselect,async I=>{I?f.value=await i(I)||rt:f.value=rt},{immediate:!0});const b=h(()=>({width:e.content.chipIconSize,color:e.content.chipIconColor,display:"flex","align-items":"center","justify-content":"center","pointer-events":"none"}));return{isSingleSelect:a,data:u,selectedLabel:l,isOptionSelected:r,localContext:o,triggerStyle:k,triggerIconStyle:P,selectedValueStyle:Y,placeholderStyle:S,chipIcon:m,chipStyle:O,chipIconStyle:b,chipIconUnselect:f,isOpen:c,handleChipClick:(I,B)=>{I.stopPropagation(),t("remove-multiselect-value",B)}}}},fn={class:"ww-input-select__trigger"},mn=["innerHTML"],vn={key:0,class:"ww-input-select__chip_container"},gn=["onClick"],wn=["innerHTML"],yn=["innerHTML"];function pn(e,t,i,n,o,a){var s,l,r,c;return _(),T("div",fn,[n.isSingleSelect?(_(),T("div",{key:0,style:D(n.triggerStyle)},[n.isOptionSelected?(_(),T("span",{key:0,style:D(n.selectedValueStyle)},K(n.selectedLabel),5)):(_(),T("span",{key:1,style:D(n.placeholderStyle)},K(n.data.placeholder),5)),x("div",{innerHTML:n.chipIcon,style:D(n.triggerIconStyle),"aria-hidden":"true"},null,12,mn)],4)):(_(),T("div",{key:1,style:D(n.triggerStyle)},[n.isOptionSelected?(_(),T("div",vn,[(_(!0),T(ie,null,se((c=(r=(l=(s=n.localContext)==null?void 0:s.data)==null?void 0:l.select)==null?void 0:r.active)==null?void 0:c.details,u=>(_(),T("div",{class:"ww-input-select__chip",key:u.value,onClick:w=>n.handleChipClick(w,u.value),style:D(n.chipStyle)},[x("span",null,K(u.label),1),x("div",{innerHTML:n.chipIconUnselect,style:D(n.chipIconStyle),"aria-hidden":"true"},null,12,wn)],12,gn))),128))])):(_(),T("span",{key:1,style:D(n.placeholderStyle)},K(n.data.placeholder),5)),x("div",{innerHTML:n.chipIcon,style:D(n.triggerIconStyle),"aria-hidden":"true"},null,12,yn)],4))])}const Sn=ue(hn,[["render",pn],["__scopeId","data-v-5e45f01d"]]);function bn({emit:e,optionElement:t,content:i}){const n=wwLib.wwUtils.getUid(),o=`ww-select-option-${i.value}-${n}`,a=E("_wwSelect:activeDescendant",p("")),s=E("_wwSelect:focusFromOptionId",()=>{});return R(a,()=>{a.value===o&&ee(()=>{t.value&&(t.value.focus(),t.value.scrollIntoView({block:"nearest",inline:"nearest"}))})}),{uid:n,optionId:o,focusFromOptionId:s}}function Ve(e,t){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>e(...n),t)}}function ct(e,t){return typeof t=="object"&&t!==null?e.findIndex(i=>typeof i!="object"||i===null?!1:JSON.stringify(i)===JSON.stringify(t)):e.indexOf(t)}function $e(e,t){return typeof e=="object"&&e!==null&&typeof t=="object"&&t!==null?JSON.stringify(e)===JSON.stringify(t):e===t}const _n='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check"><path d="M20 6 9 17l-5-5"/></svg>',Dn={props:{content:{type:Object,required:!0},localData:{type:Object,default:()=>({})}},emits:["update:content","update:sidepanel-content","add-state","remove-state"],setup(e,{emit:t}){const i=h(()=>!1),{getIcon:n}=wwLib.useIcons(),{resolveMappingFormula:o}=wwLib.wwFormula.useFormula(),a=E("_wwSelect:registerOption",()=>{}),s=E("_wwSelect:unregisterOption",()=>{}),l=p(null),r=h(()=>{var J,Z;return(Z=(J=l.value)==null?void 0:J.componentRef)==null?void 0:Z.$el}),c=E("_wwSelect:value",p("")),u=E("_wwSelect:type",p("simple"));E("_wwSelect:setValue",()=>{});const w=E("_wwSelect:isDisabled",p(!1)),k=E("_wwSelect:isReadonly",p(!1)),P=E("_wwSelect:updateValue",()=>{}),Y=E("_wwSelect:removeSpecificValue",()=>{}),S=E("_wwSelect:focusSelectElement",()=>{}),O=E("_wwSelect:activeDescendant",p(null)),m=E("_wwSelect:isMouseDownOnOption",p(!1)),f=E("_wwSelect:mappingLabel",p(null)),b=E("_wwSelect:mappingValue",p(null)),v=E("_wwSelect:mappingDisabled",p(null)),I=h(()=>({padding:e.content.optionPadding,"background-color":e.content.optionBgColor,color:e.content.optionFontColor,"font-family":e.content.optionFontFamily,"font-size":e.content.optionFontSize,"font-weight":e.content.optionFontWeight,cursor:e.content.optionCursor,"border-radius":e.content.optionBorderRadius,border:e.content.optionBorder,"--ww-select-option-bg-color-hover":e.content.optionBgColorHover,"--ww-select-option-bg-color-focused":e.content.optionBgColorFocused})),B=p(null);Gt(async()=>{B.value=await n(e.content.optionIcon)||_n});const V=h(()=>({width:e.content.optionIconSize,color:e.content.optionIconColor,display:"flex","align-items":"center","justify-content":"center","pointer-events":"none"})),L=h(()=>e.localData&&typeof e.localData=="object"&&"value"in e.localData&&"id"in e.localData&&Object.keys(e.localData).length===2?e.localData.value:typeof e.localData!="object"||e.localData===null?e.localData:o(he(f),e.localData)??e.content.label??e.localData),$=h(()=>e.localData&&typeof e.localData=="object"&&"value"in e.localData&&"id"in e.localData&&Object.keys(e.localData).length===2?e.localData.value:typeof e.localData!="object"||e.localData===null?e.localData:o(he(b),e.localData)??e.content.value??e.localData),y=h(()=>o(he(v),e.localData)),M=h(()=>F==O.value),C=h(()=>u.value==="single"?$e(c.value,$.value):Array.isArray(c.value)&&c.value.some(J=>$e(J,$.value))),{optionId:F,handleKeyDown:W,focusFromOptionId:re}=bn({emit:t,optionElement:r,content:e.content}),H=h(()=>({optionId:F,label:L.value,value:$.value,disabled:y.value,isSelected:C.value,_data:e.localData}));s(F),a(F,ht(H));const q=h(()=>!i.value&&!y.value&&!w.value&&!k.value),ve=()=>{C.value&&q.value&&e.content.unselectOnClick?(de(),re(null)):!C.value&&q.value&&e.content.selectOnClick&&(P($.value),re(F),S())},X=J=>{m.value=!0},Se=()=>{ee(()=>{m.value=!1})},be=()=>{m.value=!1},de=()=>{q.value&&(u.value==="single"?P(null):Y($.value))},ge=p({isSelected:!1,isOptionDisabled:!1,label:"",value:"",_data:{}}),we=()=>{q.value&&P($.value)};R([C,y,L,$],([J,Z,ye,ke])=>{ge.value={isSelected:J,isOptionDisabled:Z,label:ye,value:ke,_data:e.localData}},{immediate:!0});const Te={select:{description:"Select the current option",method:we,editor:{label:"Select",group:"Select Option",icon:"cursor-click"}}};return Ne(()=>s(F)),{optionRef:l,optionId:F,handleClick:ve,handleMouseDown:X,handleMouseUp:Se,handleMouseLeave:be,handleKeyDown:W,isFocused:M,activeDescendant:O,option:H,optionStyles:I,optionIcon:B,optionIconStyle:V,contextMethods:Te,data:ge,contextMarkdown:"### Select Option local informations\n\n        // - `isSelected`: Boolean indicating if the option is selected\n        // - `isOptionDisabled`: Boolean indicating if the option is disabled\n        // - `label`: The label of the option (will be overwritten if defined in the Select root element)\n        // - `value`: The value of the option (will be overwritten if defined in the Select root element)",isOptionDisabled:y}}},zn=["id","aria-selected","aria-disabled"],On=["innerHTML"];function In(e,t,i,n,o,a){return _(),T("div",{class:oe(["ww-select-option",n.isFocused?"focused":"",n.isOptionDisabled?"disabled":""]),style:D(n.optionStyles),ref:"optionRef",onClick:t[0]||(t[0]=(...s)=>n.handleClick&&n.handleClick(...s)),onMousedown:t[1]||(t[1]=(...s)=>n.handleMouseDown&&n.handleMouseDown(...s)),onMouseup:t[2]||(t[2]=(...s)=>n.handleMouseUp&&n.handleMouseUp(...s)),onMouseleave:t[3]||(t[3]=(...s)=>n.handleMouseLeave&&n.handleMouseLeave(...s)),onKeydown:t[4]||(t[4]=(...s)=>n.handleKeyDown&&n.handleKeyDown(...s)),role:"option",id:n.optionId,"aria-selected":e.isSelected,"aria-disabled":n.isOptionDisabled},[x("span",null,K(n.data.label),1),n.data.isSelected?(_(),T("div",{key:0,innerHTML:n.optionIcon,style:D(n.optionIconStyle),"aria-hidden":"true"},null,12,On)):me("",!0)],46,zn)}const wt=ue(Dn,[["render",In],["__scopeId","data-v-ced39687"]]);function xn(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var i=e.indexOf("Trident/");if(i>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var o=e.indexOf("Edge/");return o>0?parseInt(e.substring(o+5,e.indexOf(".",o)),10):-1}let Ie;function Pe(){Pe.init||(Pe.init=!0,Ie=xn()!==-1)}var Ce={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Pe(),ee(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Ie&&this.$el.appendChild(e),e.data="about:blank",Ie||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Ie&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Cn=Qt();Xt("data-v-b329ee4c");const Tn={class:"resize-observer",tabindex:"-1"};Zt();const kn=Cn((e,t,i,n,o,a)=>(_(),ae("div",Tn)));Ce.render=kn;Ce.__scopeId="data-v-b329ee4c";Ce.__file="src/components/ResizeObserver.vue";function xe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xe=function(t){return typeof t}:xe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(e)}function Fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mn(e,t,i){return t&&An(e.prototype,t),e}function ut(e){return Bn(e)||Ln(e)||En(e)||Vn()}function Bn(e){if(Array.isArray(e))return Re(e)}function Ln(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function En(e,t){if(e){if(typeof e=="string")return Re(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Re(e,t)}}function Re(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Vn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $n(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function Pn(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n,o,a,s=function(r){for(var c=arguments.length,u=new Array(c>1?c-1:0),w=1;w<c;w++)u[w-1]=arguments[w];if(a=u,!(n&&r===o)){var k=i.leading;typeof k=="function"&&(k=k(r,o)),(!n||r!==o)&&k&&e.apply(void 0,[r].concat(ut(a))),o=r,clearTimeout(n),n=setTimeout(function(){e.apply(void 0,[r].concat(ut(a))),n=0},t)}};return s._clear=function(){clearTimeout(n),n=null},s}function yt(e,t){if(e===t)return!0;if(xe(e)==="object"){for(var i in e)if(!yt(e[i],t[i]))return!1;return!0}return!1}var Rn=(function(){function e(t,i,n){Fn(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(i,n)}return Mn(e,[{key:"createObserver",value:function(i,n){var o=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=$n(i),this.callback=function(l,r){o.options.callback(l,r),l&&o.options.once&&(o.frozen=!0,o.destroyObserver())},this.callback&&this.options.throttle){var a=this.options.throttleOptions||{},s=a.leading;this.callback=Pn(this.callback,this.options.throttle,{leading:function(r){return s==="both"||s==="visible"&&r||s==="hidden"&&!r}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(l){var r=l[0];if(l.length>1){var c=l.find(function(w){return w.isIntersecting});c&&(r=c)}if(o.callback){var u=r.isIntersecting&&r.intersectionRatio>=o.threshold;if(u===o.oldResult)return;o.oldResult=u,o.callback(u,r)}},this.options.intersection),ee(function(){o.observer&&o.observer.observe(o.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e})();function pt(e,t,i){var n=t.value;if(n)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var o=new Rn(e,n,i);e._vue_visibilityState=o}}function jn(e,t,i){var n=t.value,o=t.oldValue;if(!yt(n,o)){var a=e._vue_visibilityState;if(!n){St(e);return}a?a.createObserver(n,i):pt(e,{value:n},i)}}function St(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var Hn={beforeMount:pt,updated:jn,unmounted:St};function Nn(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n&&n.push(i)||e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&n.splice(n.indexOf(i)>>>0,1)},emit:function(t,i){(e.get(t)||[]).slice().map(function(n){n(i)}),(e.get("*")||[]).slice().map(function(n){n(t,i)})}}}var Un={itemsLimit:1e3},Wn=/(auto|scroll)/;function bt(e,t){return e.parentNode===null?t:bt(e.parentNode,t.concat([e]))}var Ee=function(t,i){return getComputedStyle(t,null).getPropertyValue(i)},qn=function(t){return Ee(t,"overflow")+Ee(t,"overflow-y")+Ee(t,"overflow-x")},Yn=function(t){return Wn.test(qn(t))};function dt(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=bt(e.parentNode,[]),i=0;i<t.length;i+=1)if(Yn(t[i]))return t[i];return document.scrollingElement||document.documentElement}}function je(e){"@babel/helpers - typeof";return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(e)}var _t={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Dt(){return this.items.length&&je(this.items[0])!=="object"}var He=!1;if(typeof window<"u"){He=!1;try{var Kn=Object.defineProperty({},"passive",{get:function(){He=!0}});window.addEventListener("test",null,Kn)}catch{}}let Jn=0;var Ue={name:"RecycleScroller",components:{ResizeObserver:Ce},directives:{ObserveVisibility:Hn},props:{..._t,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,i=this.sizeField,n=this.minItemSize;let o=1e4,a=0,s;for(let l=0,r=t.length;l<r;l++)s=t[l][i]||n,s<o&&(o=s),a+=s,e[l]={accumulator:a,size:s};return this.$_computedMinItemSize=o,e}return[]},simpleArray:Dt,itemIndexByKey(){const{keyField:e,items:t}=this,i={};for(let n=0,o=t.length;n<o;n++)i[t[n][e]]=n;return i}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,i,n,o){const a=tn({id:Jn++,index:t,used:!0,key:n,type:o}),s=ft({item:i,position:0,nr:a});return e.push(s),s},unuseView(e,t=!1){const i=this.$_unusedViews,n=e.nr.type;let o=i.get(n);o||(o=[],i.set(n,o)),o.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:i}=this.updateVisibleItems(!1,!0);i||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const i=this.itemSize,n=this.gridItems||1,o=this.itemSecondarySize||i,a=this.$_computedMinItemSize,s=this.typeField,l=this.simpleArray?null:this.keyField,r=this.items,c=r.length,u=this.sizes,w=this.$_views,k=this.$_unusedViews,P=this.pool,Y=this.itemIndexByKey;let S,O,m,f,b;if(!c)S=O=f=b=m=0;else if(this.$_prerender)S=f=0,O=b=Math.min(this.prerender,r.length),m=null;else{const y=this.getScroll();if(t){let F=y.start-this.$_lastUpdateScrollPosition;if(F<0&&(F=-F),i===null&&F<a||F<i)return{continuous:!0}}this.$_lastUpdateScrollPosition=y.start;const M=this.buffer;y.start-=M,y.end+=M;let C=0;if(this.$refs.before&&(C=this.$refs.before.scrollHeight,y.start-=C),this.$refs.after){const F=this.$refs.after.scrollHeight;y.end+=F}if(i===null){let F,W=0,re=c-1,H=~~(c/2),q;do q=H,F=u[H].accumulator,F<y.start?W=H:H<c-1&&u[H+1].accumulator>y.start&&(re=H),H=~~((W+re)/2);while(H!==q);for(H<0&&(H=0),S=H,m=u[c-1].accumulator,O=H;O<c&&u[O].accumulator<y.end;O++);for(O===-1?O=r.length-1:(O++,O>c&&(O=c)),f=S;f<c&&C+u[f].accumulator<y.start;f++);for(b=f;b<c&&C+u[b].accumulator<y.end;b++);}else{S=~~(y.start/i*n);const F=S%n;S-=F,O=Math.ceil(y.end/i*n),f=Math.max(0,Math.floor((y.start-C)/i*n)),b=Math.floor((y.end-C)/i*n),S<0&&(S=0),O>c&&(O=c),f<0&&(f=0),b>c&&(b=c),m=Math.ceil(c/n)*i}}O-S>Un.itemsLimit&&this.itemsLimitError(),this.totalSize=m;let v;const I=S<=this.$_endIndex&&O>=this.$_startIndex;if(I)for(let y=0,M=P.length;y<M;y++)v=P[y],v.nr.used&&(e&&(v.nr.index=Y[v.item[l]]),(v.nr.index==null||v.nr.index<S||v.nr.index>=O)&&this.unuseView(v));const B=I?null:new Map;let V,L,$;for(let y=S;y<O;y++){V=r[y];const M=l?V[l]:V;if(M==null)throw new Error(`Key is ${M} on item (keyField is '${l}')`);if(v=w.get(M),!i&&!u[y].size){v&&this.unuseView(v);continue}L=V[s];let C=k.get(L),F=!1;if(!v)I?C&&C.length?v=C.pop():v=this.addView(P,y,V,M,L):($=B.get(L)||0,(!C||$>=C.length)&&(v=this.addView(P,y,V,M,L),this.unuseView(v,!0),C=k.get(L)),v=C[$],B.set(L,$+1)),w.delete(v.nr.key),v.nr.used=!0,v.nr.index=y,v.nr.key=M,v.nr.type=L,w.set(M,v),F=!0;else if(!v.nr.used&&(v.nr.used=!0,F=!0,C)){const W=C.indexOf(v);W!==-1&&C.splice(W,1)}v.item=V,F&&(y===r.length-1&&this.$emit("scroll-end"),y===0&&this.$emit("scroll-start")),i===null?(v.position=u[y-1].accumulator,v.offset=0):(v.position=Math.floor(y/n)*i,v.offset=y%n*o)}return this.$_startIndex=S,this.$_endIndex=O,this.emitUpdate&&this.$emit("update",S,O,f,b),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:I}},getListenerTarget(){let e=dt(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,i=t==="vertical";let n;if(this.pageMode){const o=e.getBoundingClientRect(),a=i?o.height:o.width;let s=-(i?o.top:o.left),l=i?window.innerHeight:window.innerWidth;s<0&&(l+=s,s=0),s+l>a&&(l=a-s),n={start:s,end:s+l}}else i?n={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:n={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return n},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,He?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const i=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/i)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let i,n,o;if(this.pageMode){const a=dt(this.$el),s=a.tagName==="HTML"?0:a[t.scroll],l=a.getBoundingClientRect(),c=this.$el.getBoundingClientRect()[t.start]-l[t.start];i=a,n=t.scroll,o=e+s+c}else i=this.$el,n=t.scroll,o=e;i[n]=o},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const Gn={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Xn={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Zn(e,t,i,n,o,a){const s=te("ResizeObserver"),l=nn("observe-visibility");return mt((_(),T("div",{class:oe(["vue-recycle-scroller",{ready:o.ready,"page-mode":i.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...r)=>a.handleScroll&&a.handleScroll(...r))},[e.$slots.before?(_(),T("div",Gn,[le(e.$slots,"before")],512)):me("v-if",!0),(_(),ae(st(i.listTag),{ref:"wrapper",style:D({[e.direction==="vertical"?"minHeight":"minWidth"]:o.totalSize+"px"}),class:oe(["vue-recycle-scroller__item-wrapper",i.listClass])},{default:ne(()=>[(_(!0),T(ie,null,se(o.pool,r=>(_(),ae(st(i.itemTag),vt({key:r.nr.id,style:o.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${r.position}px) translate${e.direction==="vertical"?"X":"Y"}(${r.offset}px)`,width:i.gridItems?`${e.direction==="vertical"&&i.itemSecondarySize||i.itemSize}px`:void 0,height:i.gridItems?`${e.direction==="horizontal"&&i.itemSecondarySize||i.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[i.itemClass,{hover:!i.skipHover&&o.hoverKey===r.nr.key}]]},on(i.skipHover?{}:{mouseenter:()=>{o.hoverKey=r.nr.key},mouseleave:()=>{o.hoverKey=null}})),{default:ne(()=>[le(e.$slots,"default",{item:r.item,index:r.nr.index,active:r.nr.used})]),_:2},1040,["style","class"]))),128)),le(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(_(),T("div",Xn,[le(e.$slots,"after")],512)):me("v-if",!0),fe(s,{onNotify:a.handleResize},null,8,["onNotify"])],34)),[[l,a.handleVisibilityChange]])}Ue.render=Zn;Ue.__file="src/components/RecycleScroller.vue";var We={name:"DynamicScroller",components:{RecycleScroller:Ue},provide(){return typeof ResizeObserver<"u"&&(this.$_resizeObserver=new ResizeObserver(e=>{requestAnimationFrame(()=>{if(Array.isArray(e)){for(const t of e)if(t.target&&t.target.$_vs_onResize){let i,n;if(t.borderBoxSize){const o=t.borderBoxSize[0];i=o.inlineSize,n=o.blockSize}else i=t.contentRect.width,n=t.contentRect.height;t.target.$_vs_onResize(t.target.$_vs_id,i,n)}}})})),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},inheritAttrs:!1,props:{..._t,minItemSize:{type:[Number,String],required:!0}},emits:["resize","visible"],data(){return{vscrollData:{active:!0,sizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{simpleArray:Dt,itemsWithSize(){const e=[],{items:t,keyField:i,simpleArray:n}=this,o=this.vscrollData.sizes,a=t.length;for(let s=0;s<a;s++){const l=t[s],r=n?s:l[i];let c=o[r];typeof c>"u"&&!this.$_undefinedMap[r]&&(c=0),e.push({item:l,id:r,size:c})}return e}},watch:{items(){this.forceUpdate()},simpleArray:{handler(e){this.vscrollData.simpleArray=e},immediate:!0},direction(e){this.forceUpdate(!0)},itemsWithSize(e,t){const i=this.$el.scrollTop;let n=0,o=0;const a=Math.min(e.length,t.length);for(let l=0;l<a&&!(n>=i);l++)n+=t[l].size||this.minItemSize,o+=e[l].size||this.minItemSize;const s=o-n;s!==0&&(this.$el.scrollTop+=s)}},beforeCreate(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={},this.$_events=Nn()},activated(){this.vscrollData.active=!0},deactivated(){this.vscrollData.active=!1},unmounted(){this.$_events.all.clear()},methods:{onScrollerResize(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible(){this.$_events.emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate(e=!1){(e||this.simpleArray)&&(this.vscrollData.sizes={}),this.$_events.emit("vscroll:update",{force:!0})},scrollToItem(e){const t=this.$refs.scroller;t&&t.scrollToItem(e)},getItemSize(e,t=void 0){const i=this.simpleArray?t??this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[i]||0},scrollToBottom(){if(this.$_scrollingToBottom)return;this.$_scrollingToBottom=!0;const e=this.$el;this.$nextTick(()=>{e.scrollTop=e.scrollHeight+5e3;const t=()=>{e.scrollTop=e.scrollHeight+5e3,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight+5e3,this.$_undefinedSizes===0?this.$_scrollingToBottom=!1:requestAnimationFrame(t)})};requestAnimationFrame(t)})}}};function Qn(e,t,i,n,o,a){const s=te("RecycleScroller");return _(),ae(s,vt({ref:"scroller",items:a.itemsWithSize,"min-item-size":i.minItemSize,direction:e.direction,"key-field":"id","list-tag":e.listTag,"item-tag":e.itemTag},e.$attrs,{onResize:a.onScrollerResize,onVisible:a.onScrollerVisible}),{default:ne(({item:l,index:r,active:c})=>[le(e.$slots,"default",ln(sn({item:l.item,index:r,active:c,itemWithSize:l})))]),before:ne(()=>[le(e.$slots,"before")]),after:ne(()=>[le(e.$slots,"after")]),empty:ne(()=>[le(e.$slots,"empty")]),_:3},16,["items","min-item-size","direction","list-tag","item-tag","onResize","onVisible"])}We.render=Qn;We.__file="src/components/DynamicScroller.vue";var zt={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["resize"],computed:{id(){if(this.vscrollData.simpleArray)return this.index;if(this.vscrollData.keyField in this.item)return this.item[this.vscrollData.keyField];throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)},size(){return this.vscrollData.sizes[this.id]||0},finalActive(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id(e,t){if(this.$el.$_vs_id=this.id,this.size||this.onDataUpdate(),this.$_sizeObserved){const i=this.vscrollData.sizes[t],n=this.vscrollData.sizes[e];i!=null&&i!==n&&this.applySize(i)}},finalActive(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created(){if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){for(const e in this.sizeDependencies)this.$watch(()=>this.sizeDependencies[e],this.onDataUpdate);this.vscrollParent.$_events.on("vscroll:update",this.onVscrollUpdate)}},mounted(){this.finalActive&&(this.updateSize(),this.observeSize())},beforeUnmount(){this.vscrollParent.$_events.off("vscroll:update",this.onVscrollUpdate),this.unobserveSize()},methods:{updateSize(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData(){this.watchData&&!this.vscrollResizeObserver?this.$_watchData=this.$watch("item",()=>{this.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate({force:e}){!this.finalActive&&e&&(this.$_pendingVScrollUpdate=this.id),(this.$_forceNextVScrollUpdate===this.id||e||!this.size)&&this.updateSize()},onDataUpdate(){this.updateSize()},computeSize(e){this.$nextTick(()=>{if(this.id===e){const t=this.$el.offsetWidth,i=this.$el.offsetHeight;this.applyWidthHeight(t,i)}this.$_pendingSizeUpdate=null})},applyWidthHeight(e,t){const i=~~(this.vscrollParent.direction==="vertical"?t:e);i&&this.size!==i&&this.applySize(i)},applySize(e){this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.vscrollData.sizes[this.id]=e,this.emitResize&&this.$emit("resize",this.id)},observeSize(){this.vscrollResizeObserver&&(this.$_sizeObserved||(this.vscrollResizeObserver.observe(this.$el),this.$el.$_vs_id=this.id,this.$el.$_vs_onResize=this.onResize,this.$_sizeObserved=!0))},unobserveSize(){this.vscrollResizeObserver&&this.$_sizeObserved&&(this.vscrollResizeObserver.unobserve(this.$el),this.$el.$_vs_onResize=void 0,this.$_sizeObserved=!1)},onResize(e,t,i){this.id===e&&this.applyWidthHeight(t,i)}},render(){return en(this.tag,this.$slots.default())}};zt.__file="src/components/DynamicScrollerItem.vue";function ei(e,t){const n=ft(new Map),o=(...u)=>JSON.stringify(u),a=(u,...w)=>(n.set(u,e(...w)),n.get(u)),s=(...u)=>a(o(...u),...u),l=(...u)=>{n.delete(o(...u))},r=()=>{n.clear()},c=(...u)=>{const w=o(...u);return n.has(w)?n.get(w):a(w,...u)};return c.load=s,c.delete=l,c.clear=r,c.generateKey=o,c.cache=n,c}const ti={components:{DynamicScroller:We,DynamicScrollerItem:zt,"ww-element-option":wt},props:{content:{type:Object,required:!0},wwElementState:{type:Object,required:!0}},emits:["update:sidepanel-content"],setup(e,{emit:t}){h(()=>!1);const i=h(()=>!1),n=E("_wwSelect:rawData",p([])),o=E("_wwSelect:searchState",p(null)),{updateSearch:a}=E("_wwSelect:useSearch",{}),s=E("_wwSelect:registerOptionProperties",()=>{}),l=h(()=>e.content.virtualScroll),r=h(()=>e.content.virtualScrollSizeDependencies),c=h(()=>e.content.virtualScrollMinItemSize||40),u=h(()=>e.content.virtualScrollBuffer||400),w=h(()=>wwLib.wwLang.getText(e.content.emptyStateText)),k=h(()=>{const f=n.value;return Array.isArray(f)?f:[]}),P=h(()=>!k.value||k.value.length===0?{}:k.value[0]),Y=ei((f,b)=>f.filter(v=>{var B,V,L;if(typeof v!="object"||v===null){const $=v.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),y=b.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();return $.includes(y)}else return((V=(B=o.value)==null?void 0:B.searchBy)!=null&&V.length?(L=o.value)==null?void 0:L.searchBy:Object.keys(v)).some(y=>{const M=v[y];if(!M)return!1;const C=M.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),F=b.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();return C.includes(F)})})),S=h(()=>!o.value||!o.value.value?k.value:Y(k.value,o.value.value)),O=h(()=>S.value.map((f,b)=>typeof f!="object"||f===null?{value:f,id:`id_${b}`}:{...f,id:f.id??`id_${b}`}));R(S,()=>{if(a){const f=o.value&&o.value.value?S.value:[];a({...o.value,searchMatches:f})}});const m=h(()=>({"font-family":e.content.emptyStateFontFamily,"font-size":e.content.emptyStateFontSize,"font-weight":e.content.emptyStateFontWeight,color:e.content.emptyStateFontColor,padding:e.content.emptyStatePadding,"text-align":e.content.emptyStateTextAlign,width:"100%"}));return R(P,f=>{t("update:sidepanel-content",{path:"optionProperties",value:f}),s&&s(f)},{immediate:!0}),{emptyStateText:w,filteredOptions:S,virtualScroll:l,virtualScrollSizeDependencies:r,virtualScrollMinItemSize:c,virtualScrollBuffer:u,showEmptyStateInEditor:i,dynamicScrollerItems:O,emptyStateStyle:m}}};function ni(e,t,i,n,o,a){const s=te("ww-element-option"),l=te("wwLayoutItemContext"),r=te("DynamicScrollerItem"),c=te("DynamicScroller");return _(),T(ie,null,[n.filteredOptions.length>0?(_(),ae(c,{style:{height:"100%"},items:n.dynamicScrollerItems,"min-item-size":n.virtualScrollMinItemSize,buffer:n.virtualScrollBuffer,key:n.filteredOptions.length},{default:ne(({item:u,index:w,active:k})=>[fe(r,{item:u,active:k,"size-dependencies":JSON.stringify(u),"data-index":w},{default:ne(()=>[(_(),ae(l,{key:w,"is-repeat":"",index:w,data:u},{default:ne(()=>[x("div",{style:D(w!=n.filteredOptions.length-1?{paddingBottom:i.content.optionSpacing}:{})},[fe(s,{"local-data":u,content:i.content,wwEditorState:e.wwEditorState},null,8,["local-data","content","wwEditorState"])],4)]),_:2},1032,["index","data"]))]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items","min-item-size","buffer"])):me("",!0),mt(x("div",{style:D(n.emptyStateStyle)},[x("span",null,K(n.emptyStateText),1)],4),[[an,n.filteredOptions.length===0||n.showEmptyStateInEditor]])],64)}const Ot=ue(ti,[["render",ni]]),ii={props:{content:{type:Object,required:!0},wwElementState:{type:Object,required:!0}},emits:["element-event","trigger-event","update:sidepanel-content"],setup(e,{emit:t}){const{updateHasSearch:i,updateSearchElement:n,updateSearch:o,autoFocusSearch:a,focusSearch:s,isSearchBarFocused:l}=E("_wwSelect:useSearch",{}),r=p(null),c=h(()=>r.value),u=h(()=>(e.content.searchBy||[]).filter(m=>m&&m.filter).map(m=>JSON.parse(m.filter.replace(/'/g,'"'))).flat()),w=Ve((m,f)=>{o&&o({value:m,searchBy:f})},300),k=h(()=>{const m=e.content.searchBorder?{"border-top":e.content.searchBorderTop,"border-right":e.content.searchBorderRight,"border-bottom":e.content.searchBorderBottom,"border-left":e.content.searchBorderLeft}:{border:e.content.searchBorderAll};return{width:e.content.searchWidth,height:e.content.searchHeight,"border-radius":e.content.searchBorderRadius,padding:e.content.searchPadding,margin:e.content.searchMargin,"background-color":e.content.searchBgColor,"font-family":e.content.searchFontFamily,"font-size":e.content.searchFontSize,"font-weight":e.content.searchFontWeight,color:e.content.searchFontColor,"--placeholder-color":e.content.searchPlaceholderColor,outline:e.content.searchOutline,"outline-offset":e.content.searchOutlineOffset,cursor:"text",...m}}),P=h(()=>wwLib.wwLang.getText(e.content.searchPlaceholder)),Y=m=>{var f;w((f=m==null?void 0:m.target)==null?void 0:f.value,u)},S=()=>{l.value=!0},O=()=>{l.value=!1};return R(c,m=>{n&&n(m)}),gt(()=>{i&&i(!0),o&&o({value:"",searchBy:u,searchMatches:[]})}),Ne(()=>{i&&i(!1)}),{searchElementRef:r,handleInputChange:Y,handleSearchFocus:S,handleSearchBlur:O,searchStyles:k,searchPlaceholder:P}}},oi=["placeholder"];function li(e,t,i,n,o,a){return _(),T("input",{ref:"searchElementRef",name:"select-search",style:D([n.searchStyles]),class:oe(["ww-select-search"]),onInput:t[0]||(t[0]=(...s)=>n.handleInputChange&&n.handleInputChange(...s)),onFocus:t[1]||(t[1]=(...s)=>n.handleSearchFocus&&n.handleSearchFocus(...s)),onBlur:t[2]||(t[2]=(...s)=>n.handleSearchBlur&&n.handleSearchBlur(...s)),placeholder:n.searchPlaceholder},null,44,oi)}const It=ue(ii,[["render",li],["__scopeId","data-v-3b45a4ec"]]),si={components:{"ww-element-options-list":Ot,"ww-element-search":It},props:{content:{type:Object,required:!0},wwElementState:{type:Object,required:!0}},setup(e){const t=E("_wwSelect:updateDropdownConfig",()=>{}),i=h(()=>({side:e.content.side,align:e.content.align,offsetX:e.content.offsetX,offsetY:e.content.offsetY,autoPosition:e.content.autoPosition,boundOffset:e.content.boundOffset}));return R(i,()=>{t(i.value)},{immediate:!0,deep:!0}),{dropdownConfig:i}}};function ai(e,t,i,n,o,a){return le(e.$slots,"default")}const ri=ue(si,[["render",ai]]);function ci({elementRef:e,options:t,isOpen:i,methods:{openDropdown:n,closeDropdown:o,toggleValue:a}}){const s=`ww-select-dropdown-${wwLib.wwUtils.getUid()}`,l=p(""),r=p(0),c=p(""),u=m=>{const f=t.value[m];r.value=m,c.value=f.value,l.value=f.optionId},w=m=>{if(m===null){k();return}const f=t.value.findIndex(b=>b.optionId===m);u(f)},k=()=>{l.value="",r.value=0,c.value=""},P=()=>{var m;(m=e.value)==null||m.focus()};R(t,()=>{if(k(),t.value.length>0){const m=t.value.find(f=>f.isSelected);if(m){const f=t.value.findIndex(b=>b.value===m.value);u(f)}}},{immediate:!0,deep:!0});const Y=m=>{const f=t.value.length;if(f===0)return;let b;i.value?l.value===""?b=m>0?0:f-1:b=(r.value+m+f)%f:b=0,u(b)},S=m=>{const b={ArrowDown:()=>{m.preventDefault(),i.value?Y(1):n()},ArrowUp:()=>{m.preventDefault(),i.value?Y(-1):n()},Enter:()=>{m.preventDefault(),i.value&&c.value!=null&&c.value!==void 0&&c.value!==""?a(c.value):i.value||n()},Escape:()=>{m.preventDefault(),i.value&&(o(),k())}}[m.key];b&&b()},O=m=>{const f=t.value.findIndex(b=>b.value===m);f!==-1&&u(f)};return A("_wwSelect:activeDescendant",l),A("_wwSelect:focusedOptionIndex",r),A("_wwSelect:setInitialFocus",O),A("_wwSelect:focusFromOptionId",w),A("_wwSelect:focusSelectElement",P),{dropdownId:s,activeDescendant:l,handleKeydown:S,resetFocus:k,setInitialFocus:O}}function ui(e,{updateSearch:t}){const i=p(!1),n=p(null),o=p(!1);function a(u){i.value=u}function s(u){n.value=u}function l(){ee(()=>{n.value&&n.value.focus()})}function r(u){o.value=ht(u)}function c(){n.value&&(n.value.value="",t({...e,value:""}))}return{hasSearch:i,autoFocusSearch:o,updateHasSearch:a,updateSearchElement:s,resetSearch:c,updateAutoFocusSearch:r,focusSearch:l}}const di={components:{SelectTriger:Sn,SelectDropdown:ri,SelectOption:wt,SelectOptionList:Ot,SelectSearch:It},props:{content:{type:Object,required:!0},uid:{type:String,required:!0},wwElementState:{type:Object,required:!0}},emits:["trigger-event","update:content","update:sidepanel-content","add-state","remove-state"],setup(e,{emit:t}){const i=p(0),n=h(()=>!1),o=h(()=>!1),a=cn(wwLib.getFrontDocument().querySelector("#app")),s=h(()=>e.content.selectType),l=h(()=>s.value==="single"?e.content.initValueSingle??null:e.content.initValueMulti||[]),{value:r,setValue:c}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"value",type:s.value==="single"?"any":"array",defaultValue:l}),{resolveMappingFormula:u}=wwLib.wwFormula.useFormula(),w=h(()=>e.content.fieldName||e.wwElementState.name),k=h(()=>e.content.validation),P=h(()=>e.content.customValidation);E("_wwForm:useForm",()=>{})(r,{fieldName:w,validation:k,customValidation:P,initialValue:l},{elementState:e.wwElementState,emit:t,sidepanelFormPath:"form",setValue:c});const S=p(null),O=p(null),m=h(()=>e.content.autoFocus),f=p(new Map),b=h(()=>Array.from(f.value.values())),v=p(!1),I=p(!1),B=p(!1),V=p(!1),L=h(()=>e.content.choices||[]),$=h(()=>I.value),y=h(()=>I.value||B.value),M=h(()=>e.content.disabled||!1),C=h(()=>e.content.readonly||!1),F=h(()=>e.content.unselectOnClick||!1),W=h(()=>e.content.initialState||"closed"),re=h(()=>e.content.closeOnClickOutside||!1),H=h(()=>e.content.manualTrigger||!1),q=p(null),ve=p({}),X=p(null),Se=p(0),be=p(0),de=p(!0),ge=h(()=>e.content.mappingLabel),we=h(()=>e.content.mappingValue),Te=h(()=>e.content.mappingDisabled),_e=h(()=>e.content.showSearch),J=h(()=>e.content.allowScrollingWhenOpen),Z=()=>{if(!(S!=null&&S.value))return;const d=S.value.getBoundingClientRect();ye.value={position:"absolute",top:`${d.top+d.height+parseInt(e.content.offsetY)}px`,left:`${d.left+parseInt(e.content.offsetX)}px`}};let ye=p({});const ke=h(()=>v.value&&e.content.zIndexOpen?{zIndex:`${e.content.zIndexOpen} !important`}:{}),xt=h(()=>{const d=e.content.dropdownBorder?{"border-top":e.content.dropdownBorderTop,"border-right":e.content.dropdownBorderRight,"border-bottom":e.content.dropdownBorderBottom,"border-left":e.content.dropdownBorderLeft}:{border:e.content.dropdownBorderAll};return{width:e.content.dropdownWidth,"max-height":e.content.dropdownMaxHeight,"border-radius":e.content.dropdownBorderRadius,padding:e.content.dropdownPadding,"background-color":e.content.dropdownBgColor,"box-shadow":e.content.dropdownShadows,overflow:"auto",...d}}),qe=p(Date.now()),Ct=(d,g)=>{f.value.set(d,g)},Tt=d=>{f.value.delete(d)},kt=d=>{d&&(ve.value=d)},Ye=d=>{q.value=d},Ke=d=>{if(s.value==="single")Array.isArray(d)&&(console.warn("Single select component received an array value. Only the first value will be used."),d=d[0]),c(d),t("trigger-event",{name:"change",event:{value:d}});else{Array.isArray(d)||(d=[d]);const g=Array.isArray(r.value)?[...r.value]:[];for(let j of d)ct(g,j)===-1&&(!e.content.limit||g.length<e.content.limit)&&g.push(j);c(g),t("trigger-event",{name:"change",event:{value:g}})}e.content.closeOnSelect&&G()},Ft=d=>{var N;if(d===""||d==null||d===void 0)return;const g=Array.from(f.value).find(([U,Q])=>Q.value===d);if(!g&&!(b!=null&&b.length)>1||(N=g==null?void 0:g[1])!=null&&N.disabled)return;s.value==="single"?r.value:[...Array.isArray(r.value)?r.value:[]];let j=!1,z;if(s.value==="single")r.value===d?e.content.unselectOnClick&&(c(null),j=!0,e.content.closeOnSelect&&G()):e.content.selectOnClick&&(c(d),j=!0,e.content.closeOnSelect&&G()),z=r.value;else{const U=Array.isArray(r.value)?[...r.value]:[];let Q=-1;typeof d=="object"&&d!==null?Q=U.findIndex(Le=>typeof Le!="object"||Le===null?!1:JSON.stringify(Le)===JSON.stringify(d)):Q=U.indexOf(d),Q>=0?e.content.unselectOnClick&&(U.splice(Q,1),j=!0,e.content.closeOnSelect&&G()):e.content.selectOnClick&&(U.push(d),j=!0,e.content.closeOnSelect&&G()),c(U),z=U}j&&t("trigger-event",{name:"change",event:{value:z}})};function Je(d){if(s.value!=="multiple"||M.value||C.value)return;de.value=!1;const g=Array.isArray(r.value)?[...r.value]:[],j=ct(g,d);j!==-1&&(g.splice(j,1),c(g)),t("trigger-event",{name:"change",event:{value:g}}),e.content.closeOnSelect?(de.value=!0,G()):ee(()=>{de.value=!0})}const{hasSearch:At,updateHasSearch:Ge,updateSearchElement:Mt,resetSearch:Xe,autoFocusSearch:Bt,updateAutoFocusSearch:De,focusSearch:Lt}=ui(q,{updateSearch:Ye});function ze(){if(M.value||C.value)return;const d=S.value.getBoundingClientRect();ye.value={position:"absolute",top:`${d.top+d.height+parseInt(e.content.offsetY)}px`,left:`${d.left+parseInt(e.content.offsetX)}px`},v.value=!0,ee(Z),Bt.value&&Lt()}function G(){de.value&&(Xe(),Nt(),v.value=!1)}function Ze(d=null){n.value||H.value&&d||(v.value?G():ze())}function Et(){c(l.value||null),t("trigger-event",{name:"change",event:{value:l.value||null}})}function Qe(d){re.value&&v.value&&!S.value.contains(d.target)&&!O.value.contains(d.target)&&!n.value&&Date.now()>qe.value+400&&G()}function Vt(){M.value||C.value||(I.value=!0)}function $t(){V.value||(I.value=!1)}function Pt(){S.value&&!M.value&&!C.value&&S.value.focus()}const{dropdownId:Rt,activeDescendant:jt,handleKeydown:Ht,resetFocus:Nt,setInitialFocus:et}=ci({elementRef:S,options:b,isOpen:v,methods:{openDropdown:ze,closeDropdown:G,toggleValue:Ft}});function tt(){r.value&&(s.value==="single"?et(r.value):Array.isArray(r.value)&&r.value.length&&et(r.value[0]))}const Ut=()=>{S.value&&(X.value&&(X.value.disconnect(),X.value=null),X.value=new ResizeObserver(Ve(d=>{if(d[0]){const g=S.value.getBoundingClientRect();Se.value=g.width,be.value=g.height}},16)),X.value.observe(S.value))},Wt=h(()=>{const d=new Map(L.value.map(z=>{const N=typeof z!="object"||z===null;let U,Q;return N?(U=z,Q=z):(U=u(he(we),z)??z.value??z,Q=z),[U,Q]})),g=z=>typeof z!="object"||z===null?{value:z,label:z,disabled:!1,data:z}:{value:u(he(we),z)??z.value??z,label:u(he(ge),z)??z.label??z.value??z,disabled:z.disabled||!1,data:z||{}},j=z=>{const N=Array.from(d.entries()).find(([U,Q])=>$e(U,z));return N?N[1]:null};if(s.value==="single"){const z=j(r.value);return z?g(z):null}else return(Array.isArray(r.value)?r.value:[]).map(N=>{const U=j(N);return U?g(U):{value:N,label:N,isInOptions:!1,info:"This value is not in the defined options"}})}),qt=h(()=>{var d;return((d=b.value)==null?void 0:d.map(({optionId:g,...j})=>j))||p([])}),Fe=p({options:qt,active:{value:r,details:Wt},utils:{type:s,isOpen:v,triggerWidth:Se,triggerHeight:be}});let Ae=null,Me=null,nt=!1,pe=!1,Be="";try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){nt=!0}}))}catch{}pe=nt?{passive:!1}:!1,Be="onwheel"in document.createElement("div")?"wheel":"mousewheel";const ce=d=>{d.preventDefault()},it=d=>{if({37:1,38:1,39:1,40:1}[d.keyCode])return ce(d),!1},Yt=()=>{const d=wwLib.getFrontWindow(),g=wwLib.getFrontDocument();!d||!g||(Ae={...g.documentElement.style},Me={...g.body.style},g.body.style.touchAction="none",d.addEventListener("DOMMouseScroll",ce,!1),d.addEventListener(Be,ce,pe),d.addEventListener("touchmove",ce,pe),d.addEventListener("keydown",it,!1))},ot=()=>{const d=wwLib.getFrontDocument(),g=wwLib.getFrontWindow();!d||!g||Ae!==null&&Me!==null&&(d.body.style.touchAction="",d.body.style["touch-action"]="",g.removeEventListener("DOMMouseScroll",ce,!1),g.removeEventListener(Be,ce,pe),g.removeEventListener("touchmove",ce,pe),g.removeEventListener("keydown",it,!1),Ae=null,Me=null)};R(At,d=>{d?Fe.value.search={value:h(()=>{var g;return((g=q.value)==null?void 0:g.value)||""}),searchBy:h(()=>{var g;return((g=q.value)==null?void 0:g.searchBy)||[]}),searchMatches:h(()=>{var g;return((g=q.value)==null?void 0:g.searchMatches)||[]})}:delete Fe.value.search},{immediate:!0}),R(m,d=>{De&&De(d)}),R(_e,()=>{Ge(_e)}),R(I,(d,g)=>{d&&!g?t("trigger-event",{name:"focus",event:null}):!d&&g&&t("trigger-event",{name:"blur",event:null})}),R(y,d=>{t(d?"add-state":"remove-state","focus")},{immediate:!0}),R(v,()=>{ee(Z),tt(),v.value?J.value||Yt():J.value||ot()}),R(r,()=>{ee(Z)},{deep:!0}),R([l,s],()=>{l.value!==null&&l.value!==void 0||Array.isArray(l.value)&&l.value.length?(c(l.value),ee(Ve(tt,300))):c(null),t("trigger-event",{name:"initValueChange",event:{value:l.value}})},{immediate:!0}),R(W,()=>{W.value&&W.value==="open"?ze():o.value||G()},{immediate:!0});const Oe=p({}),lt=d=>({data:g,markdown:j})=>{const z=Oe.value,N={data:{...z.data,[d]:g},methods:{},markdown:{...z.markdown,[d]:j}};wwLib.wwElement.useRegisterElementLocalContext("select",N.data,N.methods,N.markdown),Oe.value=N},Kt=lt("selectTrigger"),Jt=lt("select");return A("_wwSelect:mappingLabel",ge),A("_wwSelect:mappingValue",we),A("_wwSelect:mappingDisabled",Te),A("_wwSelect:rawData",L),A("_wwSelect:options",b),A("_wwSelect:type",s),A("_wwSelect:value",r),A("_wwSelect:setValue",c),A("_wwSelect:isDisabled",M),A("_wwSelect:isReadonly",C),A("_wwSelect:canUnselect",F),A("_wwSelect:searchState",q),A("_wwSelect:optionProperties",ve),A("_wwSelect:updateValue",Ke),A("_wwSelect:removeSpecificValue",Je),A("_wwSelect:registerOption",Ct),A("_wwSelect:unregisterOption",Tt),A("_wwSelect:registerOptionProperties",kt),A("_wwSelect:registerTriggerLocalContext",Kt),A("_wwSelect:dropdownMethods",{closeDropdown:G}),A("_wwSelect:useSearch",{updateHasSearch:Ge,updateSearchElement:Mt,updateSearch:Ye,updateAutoFocusSearch:De,isSearchBarFocused:B}),A("_wwSelect:isMouseDownOnOption",V),A("_wwSelect:localContext",Oe),Jt({data:Fe,markdown:"### Select local informations\n\n            #### options\n            Array of all available options in the dropdown. Each option contains:\n            - `value`: Option's value\n            - `label`: Display text\n            - `disabled`: Boolean indicating if option is disabled\n            - `isSelected`: Boolean indicating if option is selected\n            - `data`: Data from the repeat context (optional)\n\n            #### active\n            Information about currently selected option(s):\n            - `value`: Current selection (single value or array for multiple select)\n            - `details`: Detailed information about selected option(s)\n\n            #### utils\n            Component state information:\n            - `type`: Select type ('single' or 'multiple')\n            - `isOpen`: Boolean indicating if dropdown is open\n            - `triggerWidth`: Width of trigger element\n            - `triggerHeight`: Height of trigger element\n\n            #### search (optional)\n            Present when search is enabled:\n            - `value`: Current search input value\n            - `searchBy`: Fields to search by\n            - `searchMatches`: Options matching search criteria"}),De(m),gt(()=>{ee(()=>{Ut()}),wwLib.getFrontDocument().addEventListener("click",Qe),wwLib.getFrontWindow().addEventListener("scroll",Z)}),Ne(()=>{X.value&&(X.value.disconnect(),X.value=null),ot(),wwLib.getFrontDocument().removeEventListener("click",Qe)}),R(ve,d=>{t("update:sidepanel-content",{path:"optionProperties",value:d})},{immediate:!0,deep:!0}),{appDivRef:a,showSearch:_e,componentKey:i,isEditing:n,forceOpenInEditor:o,isOpen:v,isReallyFocused:I,isSearchBarFocused:B,isFocused:$,isAnySelectElementFocused:y,triggerElement:S,dropdownElement:O,floatingStyles:ye,dropdownStyles:xt,dropdownId:Rt,activeDescendant:jt,isDisabled:M,selectType:s,handleKeydown:Ht,handleFocus:Vt,handleBlur:$t,focusInput:Pt,toggleDropdown:Ze,resizeObserver:X,options:b,currentLocalContext:Oe,variableValue:r,lastTriggeredComponentAction:qe,selectStyles:ke,openDropdown:ze,closeDropdown:G,toggleDropdown:Ze,updateValue:Ke,resetValue:Et,removeSpecificValue:Je,resetSearch:Xe}},methods:{resetLastTriggerComponentAction(){this.lastTriggeredComponentAction=Date.now()},actionOpenDropdown(){this.resetLastTriggerComponentAction(),this.openDropdown()},actionCloseDropdown(){this.resetLastTriggerComponentAction(),this.closeDropdown()},actionToggleDropdown(){this.resetLastTriggerComponentAction(),this.toggleDropdown()},actionUpdateValue(e){this.resetLastTriggerComponentAction(),this.updateValue(e)},actionResetValue(){this.resetLastTriggerComponentAction(),this.resetValue()},actionRemoveSpecificValue(e){this.resetLastTriggerComponentAction(),this.removeSpecificValue(e)},actionResetSearch(){this.resetLastTriggerComponentAction(),this.resetSearch()},actionFocusInput(){this.resetLastTriggerComponentAction(),this.focusInput()}}},hi=["aria-haspopup","aria-expanded","aria-controls","aria-activedescendant","tabindex","aria-disabled"],fi=["id","role","aria-multiselectable"],mi=["name","value","required"];function vi(e,t,i,n,o,a){const s=te("SelectTriger"),l=te("SelectSearch"),r=te("SelectOptionList"),c=te("SelectDropdown");return _(),T("div",{class:oe(["ww-select",{"ww-select-z-index":n.isOpen&&i.content.zIndexOpen}]),style:D({"--select-z-index":n.isOpen&&i.content.zIndexOpen?i.content.zIndexOpen:"auto"}),ref:"componentKey","data-ww-flag":"ww-select"},[x("div",{class:"ww-select__trigger",ref:"triggerElement",onClick:t[0]||(t[0]=(...u)=>n.toggleDropdown&&n.toggleDropdown(...u)),onKeydown:t[1]||(t[1]=(...u)=>n.handleKeydown&&n.handleKeydown(...u)),onFocus:t[2]||(t[2]=(...u)=>n.handleFocus&&n.handleFocus(...u)),onBlur:t[3]||(t[3]=(...u)=>n.handleBlur&&n.handleBlur(...u)),role:"combobox","aria-haspopup":n.selectType==="single"?"listbox":"true","aria-expanded":n.isOpen,"aria-controls":n.dropdownId,"aria-activedescendant":n.activeDescendant,tabindex:n.isDisabled?-1:0,"aria-disabled":n.isDisabled},[fe(s,{content:i.content,onRemoveMultiselectValue:n.removeSpecificValue},null,8,["content","onRemoveMultiselectValue"])],40,hi),n.isOpen?(_(),ae(rn,{key:0,to:n.appDivRef},[x("div",{class:"ww-select__dropdown__wrapper",style:D({pointerEvents:n.isEditing&&n.forceOpenInEditor?"none":"auto"})},[x("div",{class:"ww-select__dropdown",ref:"dropdownElement",style:D([n.floatingStyles||{}]),id:n.dropdownId,role:n.selectType==="single"?"listbox":"group","aria-multiselectable":n.selectType==="multiple","aria-label":"Select options","inherit-component-style":""},[x("div",{style:D([n.dropdownStyles])},[fe(c,{content:i.content,wwEditorState:e.wwEditorState},{default:ne(()=>[n.showSearch?(_(),ae(l,{key:0,content:i.content,wwEditorState:e.wwEditorState},null,8,["content","wwEditorState"])):me("",!0),fe(r,{content:i.content,wwEditorState:e.wwEditorState},null,8,["content","wwEditorState"])]),_:1},8,["content","wwEditorState"])],4)],12,fi)],4)],8,["to"])):me("",!0),x("input",{type:"input",name:i.content.fieldName,value:n.variableValue,required:i.content.required,tabindex:"-1",class:"fake-input"},null,8,mi)],6)}const ki=ue(di,[["render",vi],["__scopeId","data-v-ac036ed2"]]),gi={props:{content:{type:Object,required:!0}},emits:["trigger-event","update:content"],data(){return{currentDate:new Date,timelineOffset:0,modoAtual:null,modoVisualizacao:[{value:"dia",label:"Dia"},{value:"semana",label:"Semana"},{value:"mes",label:"Ms"}]}},watch:{"content.visualizacao"(e,t){console.log("Watcher: mudana de visualizao",t,"->",e),e!==t&&this.$nextTick(()=>{console.log("Watcher: forando update"),this.$forceUpdate(),setTimeout(()=>{this.scrollToCurrentDay(),this.$forceUpdate()},50)})},content:{handler(e,t){e&&t&&e.visualizacao!==t.visualizacao&&(console.log("Watcher content: mudana detectada"),this.$nextTick(()=>{this.$forceUpdate()}))},deep:!0}},computed:{visualizacaoAtual(){return this.modoAtual||this.content.visualizacao||"semana"},containerStyles(){return{height:this.content.altura,backgroundColor:this.content.corFundo||"#FFFFFF",borderColor:this.content.corBorda||"#E5E7EB",color:this.content.corTexto||"#374151"}},navButtonStyles(){return{color:this.content.corTexto||"#374151",borderColor:this.content.corBorda||"#E5E7EB"}},periodoAtual(){const e=this.visualizacaoAtual;if(e==="dia")return this.currentDate.toLocaleDateString("pt-BR",{year:"numeric",month:"long"});if(e==="semana"){const t=this.currentDate.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),i=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"});return`${t} - ${i}`}else return this.currentDate.getFullYear().toString()},timelineWidth(){const e=this.visualizacaoAtual,t=this.timelineRange;return e==="dia"?(Math.ceil((t.fim-t.inicio)/864e5)+1)*50:e==="semana"?(Math.ceil((t.fim-t.inicio)/864e5)+1)*15:1950},processedUsers(){const e=Array.isArray(this.content.usuarios)?this.content.usuarios:[],t=Array.isArray(this.content.atividades)?this.content.atividades:[],i=Array.isArray(this.content.projetos)?this.content.projetos:[],n={};i.forEach(l=>{l&&l.id&&(n[l.id]=l)});const o={};e.forEach(l=>{l&&l.id&&l.ativo!==!1&&(o[l.id]={id:l.id,nome:l.nome||"Usurio sem nome",atividades:[],linhas:[]})});const a=[];t.forEach(l=>{if(!l){console.warn("Gantt: Atividade invlida encontrada",l);return}const r=n[l.projeto],c={...l,nomeProjeto:r?r.nome:"Projeto no encontrado"};if(l.data_inicio&&l.data_previsao_termino){const u=new Date(l.data_inicio),w=new Date(l.data_previsao_termino);isNaN(u.getTime())||isNaN(w.getTime())?console.warn("Gantt: Datas invlidas na atividade",l.id,l):u>w&&console.warn("Gantt: Data de incio posterior  data de fim na atividade",l.id)}l.assigned_to&&o[l.assigned_to]?o[l.assigned_to].atividades.push(c):a.push(c)}),Object.values(o).forEach(l=>{l.linhas=this.organizarAtividadesEmLinhas(l.atividades)});const s=Object.values(o);if(a.length>0){const l={id:"nao-atribuido",nome:"No Atribudo",atividades:a,linhas:this.organizarAtividadesEmLinhas(a)};s.push(l)}return s},timelineRange(){const e=this.visualizacaoAtual;if(e==="dia"){const t=this.currentDate.getFullYear(),i=this.currentDate.getMonth(),n=new Date(t,i,1),o=new Date(t,i+1,0).getDate(),a=new Date(t,i,o,23,59,59);return{inicio:n,fim:a}}else if(e==="semana"){const t=this.currentDate.getFullYear(),i=this.currentDate.getMonth(),n=new Date(t,i,1),o=new Date(t,i+2,0,23,59,59);return{inicio:n,fim:o}}else{const t=this.currentDate.getFullYear(),i=new Date(t,0,1),n=new Date(t,11,31,23,59,59);return{inicio:i,fim:n}}},scrollPosition(){const e=new Date,t=this.timelineRange,i=this.visualizacaoAtual;if(i==="mes"){if(e.getFullYear()!==this.currentDate.getFullYear())return 0;const n=e.getMonth();return Math.max(0,n-2)*150}else{if(e<t.inicio||e>t.fim)return 0;const n=Math.ceil((t.fim-t.inicio)/(1e3*60*60*24))+1,o=Math.ceil((e-t.inicio)/(1e3*60*60*24));let a=0;if(i==="dia"){const s=new Date;if(s>=t.inicio&&s<=t.fim){const l=Math.ceil((s-t.inicio)/864e5);a=Math.max(0,l-3)}}else i==="semana"&&(a=Math.max(0,o-7));return a/n*this.timelineWidth}},statusColors(){return{Pendente:this.content.corPendente||"#9CA3AF","Em desenvolvimento":this.content.corEmDesenvolvimento||"#3B82F6","Em validao":this.content.corEmValidacao||"#F59E0B",Finalizada:this.content.corFinalizada||"#10B981"}},timeMarkers(){const e=this.timelineRange,t=this.visualizacaoAtual,i=[],n=new Date;if(n.setHours(0,0,0,0),t==="mes")for(let o=0;o<=12;o++){const a=new Date(this.currentDate.getFullYear(),o,1),s=`${o*150}px`,l=a.toLocaleDateString("pt-BR",{month:"short"});i.push({date:a.toISOString(),position:s,label:l,isToday:n.getMonth()===o&&n.getFullYear()===this.currentDate.getFullYear(),isWeekend:!1,showLine:!0})}else{const o=new Date(e.inicio),a=new Date(e.fim);o.setHours(0,0,0,0),a.setHours(23,59,59,999);const s=Math.ceil((a-o)/(1e3*60*60*24))+1,l=new Date(o);for(let r=0;r<s;r++){const c=`${r/Math.max(1,s-1)*this.timelineWidth}px`;let u=!1,w="";if(t==="dia"?(u=!0,w=l.getDate().toString()):t==="semana"&&(l.getDay()===1||r===0)&&(u=!0,w=`${l.getDate()}/${l.getMonth()+1}`),u){const k=l.getTime()===n.getTime(),P=l.getDay()===0||l.getDay()===6;i.push({date:l.toISOString(),position:c,label:w,isToday:k,isWeekend:P,showLine:!0})}l.setDate(l.getDate()+1)}}return i},dayLines(){const e=this.timelineRange,t=this.visualizacaoAtual,i=[],n=new Date;if(n.setHours(0,0,0,0),t==="mes")for(let o=0;o<=12;o++){const a=new Date(this.currentDate.getFullYear(),o,1),s=`${o*150}px`;i.push({date:a.toISOString(),position:s,isToday:n.getMonth()===o&&n.getFullYear()===this.currentDate.getFullYear(),isWeekend:!1})}else{const o=new Date(e.inicio),a=new Date(e.fim);o.setHours(0,0,0,0),a.setHours(23,59,59,999);const s=Math.ceil((a-o)/(1e3*60*60*24))+1,l=new Date(o);for(let r=0;r<s;r++){const c=`${r/Math.max(1,s-1)*this.timelineWidth}px`,u=l.getTime()===n.getTime(),w=l.getDay()===0||l.getDay()===6;i.push({date:l.toISOString(),position:c,isToday:u,isWeekend:w}),l.setDate(l.getDate()+1)}}return i}},methods:{calcularPosicaoAtividade(e){const t=this.timelineRange,i=this.visualizacaoAtual,n=e.data_inicio?new Date(e.data_inicio):null,o=e.data_previsao_termino?new Date(e.data_previsao_termino):null;if(!n||isNaN(n.getTime()))return{left:"0px",width:"8px",semDatas:!0};if(n>t.fim||o&&o<t.inicio)return{left:"-100px",width:"0px",semDatas:!0};if(i==="mes"){const a=n.getMonth();if(n.getFullYear()!==this.currentDate.getFullYear())return{left:"-100px",width:"0px",semDatas:!0};const l=a*150;let r=20;if(o&&!isNaN(o.getTime())&&o>n){const c=o.getMonth();if(o.getFullYear()===this.currentDate.getFullYear()){const w=Math.max(1,c-a+1);r=Math.max(20,w/11*this.timelineWidth)}}return{left:`${l}px`,width:`${r}px`,semDatas:!1}}else{const a=new Date(t.inicio),s=new Date(t.fim);a.setHours(0,0,0,0),s.setHours(23,59,59,999);const l=Math.ceil((s-a)/(1e3*60*60*24))+1,r=Math.max(0,Math.floor((n-a)/(1e3*60*60*24))),c=r/Math.max(1,l-1)*this.timelineWidth;let u=20;if(o&&!isNaN(o.getTime())&&o>n){const w=Math.floor((o-a)/864e5),k=Math.max(1,w-r+1);u=Math.max(20,k/Math.max(1,l-1)*this.timelineWidth)}return{left:`${c}px`,width:`${u}px`,semDatas:!1}}},obterCorStatus(e){return this.statusColors[e]||"#6B7280"},organizarAtividadesEmLinhas(e){if(!e||e.length===0)return[];const t=[];return[...e].sort((n,o)=>{const a=n.data_inicio?new Date(n.data_inicio):new Date(0),s=o.data_inicio?new Date(o.data_inicio):new Date(0);return a-s}).forEach(n=>{let o=!1;for(let a=0;a<t.length;a++)if(this.podeAdicionarNaLinha(n,t[a])){t[a].push(n),o=!0;break}o||t.push([n])}),t},podeAdicionarNaLinha(e,t){const i=e.data_inicio?new Date(e.data_inicio):null,n=e.data_previsao_termino?new Date(e.data_previsao_termino):null;return i?!t.some(o=>{const a=o.data_inicio?new Date(o.data_inicio):null,s=o.data_previsao_termino?new Date(o.data_previsao_termino):null;if(!a)return!1;const l=s||a;return!((n||i)<a||i>l)}):!0},onActivityClick(e,t){this.$emit("trigger-event",{name:"onActivityClick",event:{atividade:{id:e.id,nome:e.nome,descricao:e.descricao,status:e.status,data_inicio:e.data_inicio,data_previsao_termino:e.data_previsao_termino,data_real_termino:e.data_real_termino,projeto:e.projeto,assigned_to:e.assigned_to},usuario:{id:t.id,nome:t.nome},projeto:e.nomeProjeto}})},alterarVisualizacao(e){console.log("Alterando visualizao para:",e),console.log("Visualizao atual:",this.content.visualizacao);const t={...this.content,visualizacao:e};console.log("Novo content:",t),this.$emit("update:content",t),this.modoAtual=e,this.$nextTick(()=>{this.$forceUpdate(),setTimeout(()=>{this.scrollToCurrentDay()},50)})},getButtonStyles(e){const t=this.visualizacaoAtual===e;return{backgroundColor:t?this.content.corTexto||"#374151":"transparent",color:t?this.content.corFundo||"#FFFFFF":this.content.corTexto||"#374151",borderColor:this.content.corBorda||"#E5E7EB"}},navegarMes(e){const t=this.visualizacaoAtual,i=new Date(this.currentDate);t==="dia"||t==="semana"?i.setMonth(i.getMonth()+e):i.setFullYear(i.getFullYear()+e),this.currentDate=i,this.$nextTick(()=>{this.scrollToCurrentDay()})},scrollToCurrentDay(){this.$refs.ganttBody&&(this.$refs.ganttBody.scrollLeft=this.scrollPosition)},syncScroll(){this.$refs.ganttBody&&this.$refs.timelineHeader&&(this.$refs.timelineHeader.scrollLeft=this.$refs.ganttBody.scrollLeft)},getWeekNumber(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-n)/864e5+1)/7)},criarTooltip(e){const t=e.data_inicio?new Date(e.data_inicio).toLocaleDateString("pt-BR"):"No definida",i=e.data_previsao_termino?new Date(e.data_previsao_termino).toLocaleDateString("pt-BR"):"No definida";return`${e.nomeProjeto} - ${e.nome||"Atividade sem nome"}
Status: ${e.status||"Sem status"}
Incio: ${t}
Previso: ${i}`}},mounted(){this.modoAtual=this.content.visualizacao||"semana",this.$nextTick(()=>{this.scrollToCurrentDay()})}},wi={class:"view-controls"},yi=["onClick"],pi={class:"navigation-controls"},Si={class:"timeline-header-wrapper"},bi=["aria-label"],_i={key:1,class:"gantt-rows"},Di={class:"day-lines"},zi=["title","aria-label","onClick","onKeydown"],Oi={class:"project-name"},Ii={class:"activity-name"};function xi(e,t,i,n,o,a){return _(),T("div",{class:"gantt-container",style:D(a.containerStyles),role:"application","aria-label":"Grfico de Gantt"},[x("div",{class:"gantt-controls",style:D({backgroundColor:i.content.corHeader,borderColor:i.content.corBorda})},[x("div",wi,[(_(!0),T(ie,null,se(o.modoVisualizacao,s=>(_(),T("button",{key:s.value,class:oe(["view-btn",{active:a.visualizacaoAtual===s.value}]),style:D(a.getButtonStyles(s.value)),onClick:l=>a.alterarVisualizacao(s.value)},K(s.label),15,yi))),128))]),x("div",pi,[x("button",{class:"nav-btn",style:D(a.navButtonStyles),onClick:t[0]||(t[0]=s=>a.navegarMes(-1))},"",4),x("span",{class:"current-period",style:D({color:i.content.corTexto})},K(a.periodoAtual),5),x("button",{class:"nav-btn",style:D(a.navButtonStyles),onClick:t[1]||(t[1]=s=>a.navegarMes(1))},"",4)])],4),x("div",{class:"gantt-header",style:D({backgroundColor:i.content.corHeader,borderColor:i.content.corBorda})},[x("div",{class:"users-column",style:D({color:i.content.corTexto,borderColor:i.content.corBorda})},"Usurios",4),x("div",Si,[x("div",{class:"timeline-header",style:D({backgroundColor:i.content.corFundo}),"aria-label":"Linha do tempo",ref:"timelineHeader"},[x("div",{class:"time-markers",style:D({width:`${a.timelineWidth}px`})},[(_(!0),T(ie,null,se(a.timeMarkers,s=>(_(),T("div",{key:s.date,class:oe(["time-marker",{today:s.isToday,weekend:s.isWeekend}]),style:D({left:s.position,color:s.isToday?i.content.corDiaAtual||"#3B82F6":i.content.corTexto,borderLeft:s.showLine?`1px solid ${i.content.corBorda}`:"none"}),"aria-label":`Data: ${s.label}`},K(s.label),15,bi))),128))],4)],4)])],4),x("div",{class:"gantt-body",ref:"ganttBody",onScroll:t[2]||(t[2]=(...s)=>a.syncScroll&&a.syncScroll(...s))},[a.processedUsers.length===0?(_(),T("div",{key:0,class:"empty-state",style:D({color:i.content.corTexto})},t[3]||(t[3]=[x("p",null,"Nenhum usurio encontrado",-1),x("small",null,"Verifique se os dados de usurios, atividades e projetos esto configurados corretamente.",-1)]),4)):(_(),T("div",_i,[(_(!0),T(ie,null,se(a.processedUsers,s=>(_(),T("div",{class:"gantt-user-section",key:s.id,style:D({minHeight:`${Math.max(50,s.linhas.length*30+10)}px`,borderColor:i.content.corBorda})},[x("div",{class:"user-info",style:D({backgroundColor:i.content.corHeader,borderColor:i.content.corBorda})},[x("div",{class:"user-label",style:D({color:i.content.corTexto})},K(s.nome),5),x("div",{class:"activity-count",style:D({color:i.content.corTexto})},K(s.atividades.length)+" atividade(s)",5)],4),x("div",{class:"user-timeline",style:D({minHeight:`${Math.max(50,s.linhas.length*30+10)}px`,width:`${a.timelineWidth}px`,backgroundColor:i.content.corFundo})},[x("div",Di,[(_(!0),T(ie,null,se(a.dayLines,l=>(_(),T("div",{key:l.date,class:oe(["day-line",{"today-line":l.isToday,"weekend-line":l.isWeekend}]),style:D({left:l.position,borderColor:l.isToday?i.content.corDiaAtual||"#3B82F6":i.content.corBorda,opacity:l.isWeekend?.3:.1})},null,6))),128))]),(_(!0),T(ie,null,se(s.linhas,(l,r)=>(_(),T("div",{key:`linha-${r}`,class:"timeline-row",style:D({top:`${r*30+5}px`})},[(_(!0),T(ie,null,se(l,c=>(_(),T("div",{key:c.id,class:oe(["activity-bar",{"sem-datas":a.calcularPosicaoAtividade(c).semDatas}]),style:D({left:a.calcularPosicaoAtividade(c).left,width:a.calcularPosicaoAtividade(c).width,backgroundColor:a.obterCorStatus(c.status),color:i.content.corTexto}),title:a.criarTooltip(c),"aria-label":`Projeto: ${c.nomeProjeto}, Atividade: ${c.nome||"Sem nome"}, Status: ${c.status||"Sem status"}, Responsvel: ${s.nome}`,role:"button",tabindex:"0",onClick:u=>a.onActivityClick(c,s),onKeydown:[at(u=>a.onActivityClick(c,s),["enter"]),at(u=>a.onActivityClick(c,s),["space"])]},[x("span",Oi,K(c.nomeProjeto),1),x("span",Ii,K(c.nome||"Sem nome"),1)],46,zi))),128))],4))),128))],4)],4))),128))]))],544)],4)}const Fi=ue(gi,[["render",xi],["__scopeId","data-v-f0975a25"]]);export{Fi as a,ki as e};
